const a8_0xb6410b=a8_0x37fd;function a8_0x2c81(){const _0x483f74=['sortby','TemplatePengeluaran','11809ZkZdWq','terjadi\x20error','ceil','csv-parser','4962688ehSSOr','desc','3050950DOHtep','body','636357HZmyub','555270ZagrQg','send','./csv/NOMINATIF_PERJADIN_010223.csv','search','createdAt','push','findAndCountAll','parent_id','3vtepvz','262356COlvEO','createReadStream','findAll','3216HWcqeF','125aDXYTS','create','bulkCreate','update','query','params','exports','data','log','findOne','36531099mYCVWn','36TwUoBK'];a8_0x2c81=function(){return _0x483f74;};return a8_0x2c81();}function a8_0x37fd(_0x4f285e,_0x2bbcb6){const _0x2c8177=a8_0x2c81();return a8_0x37fd=function(_0x37fd2a,_0x10efd5){_0x37fd2a=_0x37fd2a-0x175;let _0x9fc0d9=_0x2c8177[_0x37fd2a];return _0x9fc0d9;},a8_0x37fd(_0x4f285e,_0x2bbcb6);}(function(_0x3e4d0e,_0xe5da07){const _0x3ec459=a8_0x37fd,_0x36e33f=_0x3e4d0e();while(!![]){try{const _0x422ddc=parseInt(_0x3ec459(0x184))/0x1+-parseInt(_0x3ec459(0x182))/0x2*(parseInt(_0x3ec459(0x18d))/0x3)+-parseInt(_0x3ec459(0x180))/0x4+-parseInt(_0x3ec459(0x192))/0x5*(parseInt(_0x3ec459(0x18e))/0x6)+-parseInt(_0x3ec459(0x17c))/0x7*(-parseInt(_0x3ec459(0x191))/0x8)+-parseInt(_0x3ec459(0x179))/0x9*(-parseInt(_0x3ec459(0x185))/0xa)+parseInt(_0x3ec459(0x178))/0xb;if(_0x422ddc===_0xe5da07)break;else _0x36e33f['push'](_0x36e33f['shift']());}catch(_0x550357){_0x36e33f['push'](_0x36e33f['shift']());}}}(a8_0x2c81,0xf3bcf));const {Op}=require('sequelize'),model=require('../models/index'),csv=require(a8_0xb6410b(0x17f)),fs=require('fs'),getPaginationTable=(_0x21e0aa,_0x556b62)=>{const _0x1084b3=a8_0xb6410b,_0x39b53d=_0x556b62?+_0x556b62:0xa,_0x3a516c=_0x21e0aa?Math[_0x1084b3(0x17e)](_0x21e0aa-0x1)*_0x39b53d:0x0;return{'limit':_0x39b53d,'offset':_0x3a516c};},getPagingData=(_0x4f0ca5,_0xca4612,_0x4710d4)=>{const _0x5417d6=a8_0xb6410b,{count:_0x4c9c4c,rows:_0x136dc5}=_0x4f0ca5,_0x44e3d9=_0xca4612?+_0xca4612:0x0,_0x478662=Math[_0x5417d6(0x17e)](_0x4c9c4c/_0x4710d4);return{'totalItems':_0x4c9c4c,'data':_0x136dc5,'totalPages':_0x478662,'currentPage':_0x44e3d9};},getPagination=(_0x342016,_0x11c993)=>{const _0x4496be=a8_0xb6410b,_0x19edea=_0x11c993?+_0x11c993:0xa,_0x34a985=_0x342016?Math[_0x4496be(0x17e)](_0x342016-0x1)*_0x19edea:0x0;return{'limit':_0x19edea,'offset':_0x34a985};};module[a8_0xb6410b(0x198)]={async 'index'(_0x137ab5,_0x57bbea){const _0x38d5e1=a8_0xb6410b;try{const {page:_0x37ed55,size:_0x53337a}=_0x137ab5['query'],{limit:_0x4574f8,offset:_0x44c4d8}=getPagination(_0x37ed55,_0x53337a);let _0x34fe30=_0x137ab5[_0x38d5e1(0x196)][_0x38d5e1(0x17a)]||_0x38d5e1(0x189),_0x3cc648=_0x137ab5[_0x38d5e1(0x196)]['orderby']||_0x38d5e1(0x181),_0x55e1f8=_0x137ab5['query'][_0x38d5e1(0x188)]||'',_0x31754b={[Op['or']]:[{'detail':{[Op['iLike']]:'%'+_0x55e1f8+'%'}}]};if(_0x137ab5[_0x38d5e1(0x196)]['get']!='all'){const _0x379e62=await model['TemplatePengeluaran'][_0x38d5e1(0x18b)]({'where':_0x31754b,'order':[[_0x34fe30,_0x3cc648]],'limit':_0x4574f8,'offset':_0x44c4d8}),_0x4c933b=getPagingData(_0x379e62,_0x37ed55,_0x4574f8);_0x57bbea[_0x38d5e1(0x186)]({'status':!![],..._0x4c933b});}else{const _0x24ee23=await model[_0x38d5e1(0x17b)][_0x38d5e1(0x190)]({'where':_0x31754b,'order':[[_0x34fe30,_0x3cc648]]});_0x57bbea[_0x38d5e1(0x186)]({'status':!![],'data':_0x24ee23});}}catch(_0x5c4710){console['log'](_0x5c4710),_0x57bbea['send']({'status':![],'message':'terjadi\x20error'});}},async 'add'(_0x13a617,_0x2c07cb){const _0x2de93e=a8_0xb6410b;try{var _0x4a4b13=_0x13a617[_0x2de93e(0x183)];_0x4a4b13['parent_id']==''&&(_0x4a4b13['parent_id']=null);const _0x430501=await model[_0x2de93e(0x17b)][_0x2de93e(0x193)](_0x4a4b13);_0x2c07cb[_0x2de93e(0x186)]({'status':!![],'data':_0x430501});}catch(_0x2c6678){console[_0x2de93e(0x176)](_0x2c6678),_0x2c07cb[_0x2de93e(0x186)]({'status':![],'message':_0x2de93e(0x17d)});}},async 'detail'(_0x1027d5,_0x2af3ff){const _0x19e72c=a8_0xb6410b;try{const _0x5a0bea=await model[_0x19e72c(0x17b)][_0x19e72c(0x177)]({'where':{'id':_0x1027d5[_0x19e72c(0x197)]['id']}});_0x2af3ff[_0x19e72c(0x186)]({'status':!![],'data':_0x5a0bea});}catch(_0x29dd48){console['log'](_0x29dd48),_0x2af3ff['send']({'status':![],'message':'terjadi\x20error'});}},async 'update'(_0x836b41,_0x10902a){const _0x1a5ed1=a8_0xb6410b;try{var _0xdc9cdb=_0x836b41[_0x1a5ed1(0x183)];_0xdc9cdb[_0x1a5ed1(0x18c)]==''&&(_0xdc9cdb[_0x1a5ed1(0x18c)]=null);const _0x5007b7=await model[_0x1a5ed1(0x17b)][_0x1a5ed1(0x195)](_0xdc9cdb,{'where':{'id':_0x836b41[_0x1a5ed1(0x197)]['id']}});_0x10902a[_0x1a5ed1(0x186)]({'status':!![],'data':_0x5007b7});}catch(_0x54902c){console[_0x1a5ed1(0x176)](_0x54902c),_0x10902a[_0x1a5ed1(0x186)]({'status':![],'message':'terjadi\x20error'});}},async 'delete'(_0x403f75,_0x5dbaa2){const _0x4eeacf=a8_0xb6410b;try{const _0x4111a0=await model['TemplatePengeluaran']['destroy']({'where':{'id':_0x403f75[_0x4eeacf(0x197)]['id']}});_0x5dbaa2[_0x4eeacf(0x186)]({'status':!![],'data':_0x4111a0});}catch(_0x520895){console[_0x4eeacf(0x176)](_0x520895),_0x5dbaa2[_0x4eeacf(0x186)]({'status':![],'message':'terjadi\x20error'});}},async 'syncdata'(_0x3eb427,_0x3307a1){const _0x326c0c=a8_0xb6410b,_0x652335=[];fs[_0x326c0c(0x18f)](_0x326c0c(0x187))['pipe'](csv())['on'](_0x326c0c(0x175),_0x32643b=>_0x652335[_0x326c0c(0x18a)](_0x32643b))['on']('end',async()=>{const _0x4a380e=_0x326c0c;console[_0x4a380e(0x176)](_0x652335),await model[_0x4a380e(0x17b)][_0x4a380e(0x194)](_0x652335);}),_0x3307a1[_0x326c0c(0x186)](_0x652335);}};